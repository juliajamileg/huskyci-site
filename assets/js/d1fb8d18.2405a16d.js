"use strict";(self.webpackChunkhusky_site=self.webpackChunkhusky_site||[]).push([[894],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),d=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=d(e.components);return i.createElement(s.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},f=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),c=d(n),f=o,m=c["".concat(s,".").concat(f)]||c[f]||u[f]||a;return n?i.createElement(m,l(l({ref:t},p),{},{components:n})):i.createElement(m,l({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,l=new Array(a);l[0]=f;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r[c]="string"==typeof e?e:o,l[1]=r;for(var d=2;d<a;d++)l[d]=n[d];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}f.displayName="MDXCreateElement"},5110:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var i=n(7462),o=(n(7294),n(3905));const a={id:"handling-false-positives",title:"Handling false positives"},l=void 0,r={unversionedId:"guides/handling-false-positives",id:"guides/handling-false-positives",title:"Handling false positives",description:"Vulnerabilities may fail your CI pipeline even if you consider them as false positives. This section will guide you to overcome this situation when handling issues.",source:"@site/docs/guides/handling-false-positives.md",sourceDirName:"guides",slug:"/guides/handling-false-positives",permalink:"/docs/guides/handling-false-positives",draft:!1,tags:[],version:"current",frontMatter:{id:"handling-false-positives",title:"Handling false positives"},sidebar:"docs",previous:{title:"Integrating with SonarQube",permalink:"/docs/guides/integrating-with-sonar"},next:{title:"Accessing interal repositories",permalink:"/docs/guides/accessing-internal-repositories"}},s={},d=[{value:".huskyci",id:"huskyci",level:2},{value:"False positives generated by GitLeaks",id:"false-positives-generated-by-gitleaks",level:2},{value:".gitleaks.toml",id:"gitleakstoml",level:3},{value:"Files",id:"files",level:3},{value:"Commits",id:"commits",level:3},{value:"Example",id:"example",level:3}],p={toc:d},c="wrapper";function u(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Vulnerabilities may fail your CI pipeline even if you consider them as false positives. This section will guide you to overcome this situation when handling issues."),(0,o.kt)("h2",{id:"huskyci"},".huskyci"),(0,o.kt)("p",null,"A file named ",(0,o.kt)("inlineCode",{parentName:"p"},".huskyci")," can be placed on your project's root directory to be read and have it's contents ignored by a HuskyCI analysis. To create this file, you can follow the example below:"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},".huskyignore")," file is used by HuskyCI to define which folders and files should be ignored during the tool's execution."),(0,o.kt)("p",null,"When configuring the ",(0,o.kt)("inlineCode",{parentName:"p"},".huskyignore"),', only the folders "vendor", "vendors", "tests", "test", "scripts", "script", "doc", and "docs" are allowed to be ignored. To do this, you should create a file named ',(0,o.kt)("inlineCode",{parentName:"p"},".huskyignore")," in the root directory of your project. Within this file, list the folders that will be excluded from analysis. Additionally, if you wish to ignore specific folders or files, you can do so by following the format ",(0,o.kt)("inlineCode",{parentName:"p"},"folder/specific-folder")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"folder/file.json"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"[HuskyCI-Ignore]\n\n# Folders to be ignored\nvendor\nscripts\ndoc\n\n# Specific folders or files to be ignored\ndoc/arquivos\nscripts/arquivo.json\n")),(0,o.kt)("p",null,'Remember to replace "doc/files" and "scripts/file.json" with the actual paths of the files you want to exclude. Additionally, ensure to keep the ',(0,o.kt)("inlineCode",{parentName:"p"},".huskyignore")," updated as your project evolves, adding or removing folders and files as necessary."),(0,o.kt)("p",null,"When configuring the ",(0,o.kt)("inlineCode",{parentName:"p"},".huskyignore"),", be careful not to include extra spaces or disallowed characters in the folder or file names. This will ensure that the configuration is correctly interpreted by HuskyCI during execution."),(0,o.kt)("h2",{id:"false-positives-generated-by-gitleaks"},"False positives generated by GitLeaks"),(0,o.kt)("h3",{id:"gitleakstoml"},".gitleaks.toml"),(0,o.kt)("p",null,"As HuskyCI uses ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/zricethezav/gitleaks"},(0,o.kt)("inlineCode",{parentName:"a"},"gitleaks"))," to audit git repositories for secrets, a ",(0,o.kt)("inlineCode",{parentName:"p"},".gitleaks.toml")," file can be used to add an allow list when needed. To do that, simply add this file into the root of your repository, as the following example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'title = "huskyCI gitleaks config"\n[whitelist]\nfiles = [\n    "(.*?)(jpg|gif|doc|pdf|bin)$",\n    "^vendor/(.*?)$",\n    ".gitleaks.toml",\n]\ncommits = [\n    "444f28d5437ad3127702bf1b0779ae6cd00ab146",\n]\n')),(0,o.kt)("h3",{id:"files"},"Files"),(0,o.kt)("p",null,"The following examples can be used to include files into the allow list using regex, as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'files = [\n    "(.*?)(jpg|gif|doc|pdf|bin)$",\n    "^vendor/(.*?)$",\n    ".gitleaks.toml",\n]\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"(.*?)(jpg|gif|doc|pdf|bin)$")," will not consider any file that has these specific extensions."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"^vendor/(.*?)$")," will not consider any file inside the ",(0,o.kt)("inlineCode",{parentName:"li"},"vendor/")," folder."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},".gitleaks.toml")," will not consider this particular file into the scan.")),(0,o.kt)("h3",{id:"commits"},"Commits"),(0,o.kt)("p",null,"The following example can used to include a particular commit into the allow list, as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'commits = [\n    "444f28d5437ad3127702bf1b0779ae6cd00ab146",\n]\n')),(0,o.kt)("h3",{id:"example"},"Example"),(0,o.kt)("p",null,"Imagine that you have a ",(0,o.kt)("inlineCode",{parentName:"p"},"connect.go")," file in your git repository with the commit hash ",(0,o.kt)("inlineCode",{parentName:"p"},"444f28d5437ad3127702bf1b0779ae6cd00ab146"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func ConnectDB() error {\n\n    username := "root"\n    password := "*hb123:0l"\n    host := "http://myinternal.url.to.host"\n    port := "3360"\n\n    err := mongoConnect(username, password, host, port)\n\n    return err\n}\n')),(0,o.kt)("p",null,"After mitigating the vulnerability by invalidating the password, using a new one, and adding environment variables logic, your new code can look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-go"},'func ConnectDB() error {\n\n    username :=  os.Getenv("DB_USER")\n    password := os.Getenv("DB_PASSWORD")\n    host := os.Getenv("DB_HOST")\n    port := os.Getenv("DB_PORT")\n\n    err := mongoConnect(username, password, host, port)\n\n    return err\n')),(0,o.kt)("p",null,"When running HuskyCI again, you may realize that ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/zricethezav/gitleaks"},(0,o.kt)("inlineCode",{parentName:"a"},"gitleaks"))," will still fail your CI, because the old commit ",(0,o.kt)("inlineCode",{parentName:"p"},"444f28d5437ad3127702bf1b0779ae6cd00ab146")," stills has credentials in it. "),(0,o.kt)("p",null,"The point is: you should ",(0,o.kt)("strong",{parentName:"p"},"NOT")," whitelist the ",(0,o.kt)("inlineCode",{parentName:"p"},"connect.go")," file into  ",(0,o.kt)("inlineCode",{parentName:"p"},".gitleaks.toml"),"! By doing that, any new hardcoded passwords in this file will not be checked anymore. The correct way is to add the commit itself:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'title = "huskyCI gitleaks config"\n[whitelist]\ncommit = [\n    "444f28d5437ad3127702bf1b0779ae6cd00ab146",\n]\n')))}u.isMDXComponent=!0}}]);